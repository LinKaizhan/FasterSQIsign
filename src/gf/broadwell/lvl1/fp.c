#include "include/fp.h"

const uint64_t p[NWORDS_FIELD] =  { 0xffffffffffffffff, 0x252C9E49355147FF, 0x33A6A86587407437, 0x34E29E286B95D98C };
const uint64_t R2[NWORDS_FIELD] = { 0x233625AE400674D4, 0x20AFD6C1025A1C2E, 0x30A841AB0920655D, 0x0D72E7D67C30CD3D };
const uint64_t pp[NWORDS_FIELD] = { 0x01, 0x00, 0x00, 0x00 };

const fp_t fp_1 = { 0x4, 0x6b4d86db2abae000, 0x31655e69e2fe2f23, 0x2c75875e51a899cf };
const fp_t fp_2 = { 0x9, 0xB16E6F6D20247800, 0x2F24146E3EBBEA0F, 0x2408709437BB5A12 };
const fp_t fp_inv2 = { 0x2, 0xB5A6C36D955D7000, 0x98B2AF34F17F1791, 0x163AC3AF28D44CE7 };
const fp_t fp_inv3 = {0x5555555555555556, 0x91e24124871f2555, 0x32e63a66fb2a5d30, 0x3213968fb846c44d};
const int p_even_cofactor_minus_1_limb = 2;
const uint64_t p_even_cofactor_minus_1[3] = { 0x86E4A593C926AA28, 0x318674D50CB0E80E, 0x69C53C50D72BB };
const uint64_t p_even_cofactor_minus_1_highest = 0x4000000000000;
const int strategy[15] = {5, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
const fp_t Lookupbasere = {0xF2A7C82963B58937,0xAD6E31499AE806CD,0xB2AFE597C25860A8,0x26650B3B04E8524A};
const fp_t Lookupbaseim = {0x7C97AAF98EB6C5B,0x703A35529DD21E3F,0xF7CC506E5303D5D6,0x336F91D4490FCE5F};
const fp_t Lookuptable[448] = {
    {0xf2a7c82963b58937,0xad6e31499ae806cd,0xb2afe597c25860a8,0x26650b3b04e8524a},
    {0x7c97aaf98eb6c5b,0x703a35529dd21e3f,0xf7cc506e5303d5d6,0x336f91d4490fce5f},
    {0xeb40a60b530eb8c3,0xd199754d98fea4a8,0xc91682972d1d67fa,0x107fa93c227ee0ea},
    {0x9e0f9dd03f80970e,0x5478fbe38aa32e3,0x4040f1d986a1d290,0x11786c8b2c1f9851},
    {0x31ad8bc2604be965,0x20257ed1413aed3b,0xc0cdf3e11758f20e,0x50a383d84473c86},
    {0xbfd4a330b26a135c,0x7a54759a01c5d4aa,0x23c8efbd9a270501,0x2769d34b947f0b9c},
    {0x349ed630c1b26a8d,0x50b4d7fed6d91c83,0xabcd22c684d1ef13,0x125930777fb762c7},
    {0xe58b4fe69c055465,0xa23e2d7b3db322fd,0xb8e27c5f485df2e2,0x26b8653554f160d0},
    {0x78789820f81ea4f8,0x1606f513f4bd43da,0x3992a43ff314c9b0,0x21fd5fe1755b88d8},
    {0x5036db8acc9f8ca1,0xc0dfa024c045785b,0xb57657bfa6405d3e,0x2da6a09b501c4697},
    {0x1806b5a4cc0273bd,0xe727c71a8fe7c88c,0x9b4eea9a00df40cc,0x3408a52ed80aa814},
    {0xfa16569e5cc630f9,0xf45f0320e3e10585,0x34cd8b5167232611,0x15fa8783b7358797},
    {0xd0da1710faaf17b1,0x13a8eb44973c8ace,0xee47a9d64fc032ae,0x145d208ed4d1a0ad},
    {0x4a159166b9a90d0f,0xbffd579d9b915604,0x575c80a1d276f54b,0x2dea8686f98f0d47},
    {0x619e14a55ae9f67a,0x26749e9565c2c91d,0xe8ff28479a6962f6,0x28aef1715851171e},
    {0x20dc6625e9f7a3c2,0x797d0666175691c8,0x621693d144b4eab7,0x1ae7c977cd16489b},
    {0xf92687054e17c518,0xb5f536c5e72bd148,0xecfc79be7522c3b,0x24a989911ebba626},
    {0xa798da094465190,0xb33f5c34135d927,0xfcf8da16a7acc0a3,0x291df6ed8cf9a593},
    {0x27b0a2c8ba4a87af,0x104377878d5e7312,0xb66143f75a1f0dd8,0x324f903b612ad03b},
    {0x35eb50d391cf900,0xd304057ba4ec6e8e,0xb259143e65cfe37f,0xa678d60f0c28a8},
    {0x895f063b13affdf7,0x3585309c911745c3,0x1551202a8c5ad080,0x82e05068e147fd9},
    {0x19bb90fa93fd9b9c,0x9b5f7995e7f18c02,0x110fdd067040fd32,0xf66daeaca204d9b},
    {0x6b7d0d19582d66e4,0xa622a55b5cf03043,0x79b3cb7969588756,0xfcd9b4811c3accd},
    {0xf263e3b62f04d548,0xa5e525f1e1f76145,0xf3a389a8551bab59,0x14c4c549df49a8c1},
    {0x2bcf684684e7631b,0xab74810c0f1c400c,0x34f31e247846c56c,0x15a2ab220d80c8c7},
    {0xf4f771c39e2f6f0,0xdcbc0bbe9558ee64,0x4ebdb3401a3120bd,0xade94071dcf389d},
    {0xc095589fa1403df7,0x5cb0eee253dfa2b7,0xe81792071ffe55f6,0x2e1bec827cfbdec6},
    {0x3af87d21b578aa37,0xe15f64f6656c19bd,0x3b0365d1e474d7af,0x54bbd06286f6e8d},
    {0xc5f29902a3dc7fb2,0xd756c438c7fe6221,0x32bb54d6e5bc4431,0x257d1a4ca7703bbe},
    {0x7ef0b1c0d8999988,0xb19cd718cdd467a0,0xc8408f393ab6ff30,0x1007f0b07ac650ae},
    {0xedfebe8851492ec,0x3b238dcf09d11bcb,0x531d87848d56b5b7,0x33751cb4a0b638a0},
    {0xd78123daa606cce8,0xa3450554f072ade4,0xe6736f7deda0583b,0x104d63bfaafce662},
    {0xde1f0b1031505419,0x43432b318c82717e,0xf5d4fd00510536ce,0x30f9ebe3726221a4},
    {0xb0d03c8a6949eb5a,0xfd3f841477f594aa,0x18eb7d27d0b08b,0x2124c42011037603},
    {0xc9e6ce2e5fa6f9d5,0xf44a4a796a9ef9a9,0x7ce59d86bafa3fc4,0xaf74d1a5e08a072},
    {0x4acced742428a6cd,0x1c42afd7f609493f,0x3d662a5dc4e35a98,0xf873461bd8b9c53},
    {0xf1715f3e77a93100,0x5ba1334c7452d440,0xb1690d84dbe35ac4,0x21b91e0663d17893},
    {0xff695d7dbea22619,0xd57730c429fd427,0xe6555cc25f13f130,0xacd45d446f195d5},
    {0x84c3dd061ab7a5bc,0x3012f1435fb145ab,0x69e88aee34d891ef,0x2df84a7904c9df68},
    {0x7da55adca4a5af52,0x20e5611ff36e87aa,0x1e59acb58f7b505a,0x2734c0b1c12b0ea1},
    {0x78d9005db13329ea,0x348d5e91d703361f,0x9da1741452372f97,0xd7e19f29b7f329a},
    {0x144bbb536c44c332,0xa71070195dfa86ad,0x2b80f9a6ead1ee01,0x215dc1cb5ef7c8f4},
    {0x7765ca5c5362c628,0x45371c00c050ffb6,0xb1698c2653a99e56,0x15c5e1a1714746cf},
    {0xeff58c62f3bab6a5,0x46726834870d6840,0xd6658e9cb0b1f2ec,0x6d666d5b524d814},
    {0x751cf72610986aea,0x175476a6dae16be8,0x45d43f6fe8c6154d,0x26fd036294299f13},
    {0xcd53f3b3bf230ab3,0xc3857ebf488e08b1,0xf045c079d30bb8c3,0xccd01bbbc1d9dca},
    {0x1077759a03d4314f,0x6ce665baf1cfec32,0x3f59eede934b9dae,0x1a6a47a0b55c661b},
    {0xf1a8cb2a227bb0a5,0x6a98ba94be65a720,0xc9d1fcf084700946,0xa4182068c384f85},
    {0x1405c46feac69656,0xe610915061500991,0xb50d472919d9a6ca,0x76d464aa6c716dd},
    {0x8d9033c14a2d2a9d,0xdbf69d5a0d22ad6c,0x4850509c2ef2595c,0x3297f67770a56905},
    {0xa2d93c6b9d985462,0xb6fc2f238a05ea86,0x5edf1fbaa4a55031,0x1d48a7f878ef1280},
    {0x929a0d27ad0e3a44,0x787ac6b598ae6dbc,0x2d6cc180c8c345c4,0x6d588b004c8ac9a},
    {0x83639a0f7d53c5e8,0x74c8a6408f47d6cb,0x2034cc4c922ba4e2,0x2ca3a73ef2eb792a},
    {0x9765d51f3e8db460,0x602d1e5566fded86,0xb8e7d5202ba186c7,0x6f345308bc2ad22},
    {0x3ad9ed1f346149df,0xd8dd5b7ad2eb5241,0x832bfd9ec9805256,0x3053eee7ff8e6df8},
    {0x6a34f14dbe74669e,0x5844c2053b74d70d,0x78a7f45ada6f3c09,0xff31a168e84569},
    {0x414e46b2fd034241,0x97cb9935b7c01033,0x71cd2459ce869748,0x29321cc54072890},
    {0x9a6cff6324e6f094,0x45d911774130d3c0,0xcfdd5bf837c5f742,0x2c39d971704f6a0d},
    {0xb94a5561942442bc,0x73eb9b911d693f42,0x656eaa8b2c9091e6,0x273fa75e0cf2185b},
    {0x8ab05a766bdb8ab1,0xcd5d631ec718e88,0x7ed51a039308fe41,0xf290fe8011f06f9},
    {0x8affbd3b8d7e0e11,0x4badc23d57dd355,0xeb02638f9a7ff6ea,0xa489803bee64418},
    {0x4efab0cc43d85c8e,0x7c4fa40fc318ddd,0xf5e4e6fdcf0fecd5,0x23314d1497c13097},
    {0x1b70d1d2f150cb06,0x2b261ddc98f5b53,0x99a0a3a2d430a202,0x139a5b9a72e4a770},
    {0x2b4fecde5cef1b50,0x2f7ad2e5a3dedb66,0xd2cc5cf29f71ec6a,0x1eae4d0e480d5336},
    {0xeed41f72962c8662,0x7166f247971d144f,0x925beea046e3f153,0xfeadce51855d2b4},
    {0x849fb41f75fe9893,0x6b14e818e24c1ed,0xe49c0e57c1ca528a,0x2c8dd425e934dce7},
    {0xe4000c1fc949c5f7,0x9de132fb73be6b9e,0x3254e70f4dfd7f5,0x510f864a5196169},
    {0xeeee735ecd844f2f,0xda219e0fac649ae6,0x486a1aaa27a9a771,0x1f27cb288148e91},
    {0x44c64a6c1cfe2c81,0x6b83c9d0bdec49d4,0x79cc7ef24e282263,0xd6bdf3542d939b0},
    {0x6dd9c6aaad326432,0x956760874b7a4d4b,0x74d41e9722e7e291,0x112b6365477156d2},
    {0x9ee97792cc81e90f,0x5f49de023ea4da80,0x7aab5276a9bfa431,0x1d34db252eb094e9},
    {0x8dd18483f24b7d4e,0x91191acd4f919b9d,0x1301b250b6098e76,0x21d65a4ce467d71f},
    {0xacc2a6fc5a5a2275,0x2d91f8842eebce72,0x191585b6635c5df0,0x5a6f9bf692ad30e},
    {0xf0900ea6af73abd1,0x4ee29aeac7cf4cd7,0x854835dd0589f0f0,0x341683f55ae654e5},
    {0x558cea5d570fd87,0xe22d7554df8335dd,0xf52d1de7a22b42e7,0x18be7596ccaccf8f},
    {0x52b874f6e2f16f48,0xff95b0c4c37cb54e,0xad08bc800e71344f,0x1ce011105ccd331},
    {0xba59b671a612ac4d,0x155dea8d7d63456a,0xb4409b5acc562934,0x19ab83186fdef8c1},
    {0xf422ee94cd43c9b5,0x107b0b81c0ccb1b5,0xa43c1c85b8a1d08e,0x115950b0ecf30425},
    {0xfa03d3065893bb57,0x994ec2c0220404b9,0x63b7360399e40365,0x3435a65693e32b3},
    {0xf399c803ae7d39e8,0xadd0e6a91123078a,0xb25bf4162a273e47,0x1ca5213132aa1197},
    {0xb906fc2e0e54eb2c,0x597709e64dd0e43,0xa105cee5b2860fe5,0x6d7bf03fd35817f},
    {0x2d0f23337d9c2f1b,0xcb715e43f5036044,0x2639bc4af54341cf,0x2e2ff4456903370a},
    {0x739ffc5f5ad7642c,0xc78a7e9778fe827,0xf555f8341fdaa475,0x1176c5e201fbf433},
    {0x938262a6cbd28a8,0xabe6b5a5cd4bbb73,0x6a90dd223654a0c0,0x2f6ccb24c212239b},
    {0x5a8a95c4e139775c,0x596f581de6dc80a,0x56800bdd64a6fbfa,0x3387c5a1662192f},
    {0x58adef889180b044,0xa6d6b2e0dd452493,0xf28918d6a6d93d77,0x1aa588a53099994b},
    {0x61693f3e2f133c3c,0x1c93cdf202428011,0xa5bfde692ae204d7,0x7104780b617d4bd},
    {0xede71a5673bac0ac,0x61697e30b1294238,0xf2b4f0ccf091423d,0x2abf63f29ea8d8cf},
    {0xa59f2db102aa7a60,0x10824bf5f54d81be,0x579adb2ce3e9c93a,0xdaaa4ff8a936120},
    {0x723e00e177cb80d,0x8ac5e6122369f8e2,0x63887e34478c2749,0x1c6b7aed70133127},
    {0x4f8aa9c773467922,0x3de33a88bfad223a,0xbb847dbf01e5a727,0x181be3834f5db931},
    {0x377a9088a6983b00,0xd1922c6c392a5a26,0x6e3070778fd85cce,0x25f6d9a0b5d26a99},
    {0x28ae97c2c12b10a5,0x88c76015f5f4ffe5,0xb0aac16be529cba,0x7ca0c372e76c422},
    {0x491e61e1820a4031,0x82fc457f99f749ca,0xcbeed681e702bc5b,0x23ca383d7b98675b},
    {0xe20e145a30159001,0x5a6a32cdf556c3f4,0xdd401aafca7383e4,0x23ab8bb5b74a8dff},
    {0xbbedc7f9f41f0939,0x8eb866a5db86bead,0x6c442a8ed43a87e,0x2aabce9369de3361},
    {0xaf4d0c2ce36c7caa,0x45d48ce2d8f2f844,0x310f7e9c817fc1b0,0x2a563817b5d67779},
    {0xf0b48bbd5c2b3af5,0xc39654863c74c4a5,0x3ec967583e8c7bff,0x2dcc49761bf9cf5f},
    {0x6eeec71cec646149,0x3ffb9d231bf8d134,0xbf953e388eed68eb,0x57f937717abbc3e},
    {0x4c5de0e89d894f47,0x1d19e8d9325677b2,0xf8729a75742c5ab0,0x30efb9c379135488},
    {0x1635a739449bf620,0xcfaa238e1dbdd01b,0x504a42e6ed55c78e,0x4ae0f06d00ac971},
    {0x238a71dbf4353cb9,0x7dc8d8dd1b9b4a2f,0x5c67162afa5776be,0x3404fdf04ff12d0e},
    {0x725bdd9da2dec611,0xfb2f11167b154362,0xfe6ee862dfc9c7e6,0x8d5d260b23a083c},
    {0xf725330bb02d628a,0x6d117d3e3a01364b,0x99fbb957f579b6e4,0xbf7816af4f89619},
    {0x19ad03a0275ac8af,0x247175900b8672ee,0xb72918afa1ac9043,0x196bc3335003932f},
    {0x38d004a2743cf8de,0x74771aaa364cf809,0x6ed11d7e92d94b35,0x329ebe129a9dce0f},
    {0x20f88fea127865a,0x744aac048df8b3ed,0xd7d0c6c185131cc8,0x15039fd7f114eb8c},
    {0x36e98ddf10d83ec3,0xa635454eb7a73b89,0x7a85b597c91951a8,0x2017176dafe627f8},
    {0x74d8d6d4b6f003ae,0xb1026d743503a8ea,0x345f9633b9383de7,0x2244ff2d39e9fd1c},
    {0x71ee012575c1da8f,0x73c4331fb7bb85e5,0xf7a4e34472b6d319,0x835809b66c68d30},
    {0x9e9610c83e897182,0xd2264a06e0452f0d,0x9218d410a88d35c1,0x22da3e49559bc875},
    {0xeb66d53df1aa7301,0xa16a50433aec67bc,0xda875533979cec7f,0x288adb6121e06602},
    {0xc963a5fa8d9b925,0x349e290f6cac3bf1,0x23aae53742253055,0x8bca3433c64111a},
    {0xb88e8c889ce5ddf,0x9114be90b6840837,0xabb6129a76091720,0x3123604661f0993f},
    {0x9dd372737c3f981f,0x7f9adadf76951da3,0xb7b125269bf0a39d,0x34d5b6accd13e361},
    {0x6e3795e6ac2faa7e,0x84225556361fb0c9,0x596b41728f806817,0x64ccddbf0a44d08},
    {0xef1db9178924e40,0xc4a2179d6c136457,0xf465d3dbb12a3eda,0xac6637528e91c42},
    {0x29bb02b078c08540,0xb88e6626f549cf98,0x684155d4a37a74b7,0x8ae203479211961},
    {0x38b675f2265cfb4e,0xba938bd999de4b88,0xcca612e04184887,0x22a77a8b041a5ad6},
    {0x5a0e9b9d3203386b,0x597bb2edfce1539,0x21a8ebe5f9532d67,0x29ed1298a9e997de},
    {0x218391720c73ccd4,0xa322a12916b92de2,0xb0b6a47f25a0f64e,0x1ed566ed7680799e},
    {0xed424994c10d37be,0xe680387dcd49d099,0xb737036dcece69b4,0x59b832ca073c9be},
    {0x3b027e80446909a8,0x9d01dc17c559d29d,0xd14a8b6170621c3,0x3079381769ee5ac7},
    {0xbd9c5f35e9baa167,0x8a3f493e2efee6a0,0xfa17995c2721bfa9,0x1371c316ec8324ae},
    {0x420902489373ddf1,0x62d14cd75d7c1a12,0xf3b3ffbacaff0fd3,0x1191e11fd28f6885},
    {0xac4261f096b87a06,0x6fa77d78e21239a0,0x316d4461fe99a1ae,0xff3c3538c70f070},
    {0xe91242bbfe28b115,0x666884ade999d803,0xc06f4c0310393868,0x1be486533b1f896d},
    {0x1db897b8af3d3cdf,0x711d07c4508062b5,0x81546923520ee5aa,0xc2a6278087d9008},
    {0x64d7a436da6d70a5,0x644facaae8484dec,0xe76535b43402cf55,0x2791ff4ea81a5302},
    {0x7b49ce614d8fa586,0x57cf40bb4d7b3692,0x4720c62cbc259b60,0x1a34c646093a843d},
    {0x7b5b306cce7a76c2,0x876d99a2eee3edeb,0xd60ab109b9478f4e,0x2f9f05a97a28a21f},
    {0xff365d60a9eb3ff9,0x2e0893d172f519f6,0x4eef17b6dc1182f5,0x8f369c754e49ae9},
    {0x7e414ecac499d18f,0xe06cc5b514e54b56,0xae217495a79fc5ab,0x217482f83e4b320b},
    {0x6ef0405d4fbff2f5,0x9193e24e5c7b0d5a,0x7e2a24ecc033f0fc,0x9cc0bce283fdf69},
    {0x9e34b00994f672fe,0x5987e4094b006038,0xd2ae29973601d342,0x323e88e51d80b231},
    {0x18f071b96fb5cb92,0xa0563cda452310c7,0x16649be61fc8e457,0x1214fd5a5435fc9},
    {0x22478c146de6dbf9,0x2e2d3589283cb33e,0x43b7f8ed6d9bd8df,0x25853956a82f57ad},
    {0xddf02455abc0ceff,0xb9b631d2a360a960,0x70724a978260343f,0xb38ac752f0a41e0},
    {0x2daed06327600989,0xab1bdeba9e081898,0x700b0d3d0300c587,0x344b290381e37814},
    {0xdeadbbdd57f4db08,0x578c29eed20c8efa,0xc0532b38497a2cd8,0xa3717c585dc475a},
    {0xa5bebcfc613d4c99,0x7cfa16ff0ab345e3,0x997b59d63f754981,0x2ba1135514278183},
    {0x6ef14437c9089f32,0x37a0d26075ac9c1f,0x5ede841be5dcfad9,0x2e579101791b2dee},
    {0x9dae1cda89e2943,0x9d1ae318dc0adbb4,0x2a25e04e1388e5a1,0x4b1d981f3113eb9},
    {0x5f6330100448efd9,0x969fff408f9edbe1,0x18e1ff49657b125e,0x2c861014b672f6cb},
    {0x117b8b358548a7b9,0xad90a23b4b096397,0x624efc66c4d6e946,0x1e1f5b4e1381323d},
    {0x134e55da25fc41b0,0x5415b50dd39aecc9,0x460391afdf322582,0x41b5c543cf34537},
    {0x8fe311b218c0d708,0x535bb198c68c6ebb,0x2ad2a57595d19bf9,0x24b7c7ab2e80b7b5},
    {0xb558b63e2e9b31de,0xda87357a0db43539,0x9358384c92e61cda,0x1f6cb5c5fb0038e1},
    {0x9503da4c9441ab27,0x8e6e9b382e3ba01e,0x30fb46b8e9fe1130,0x20265e0983635a33},
    {0x8455cc2ed02f45b9,0x32f54d02fbdc27da,0xe60c7e7599706791,0x24a90e24bf5a4b6d},
    {0x147e7b8f3a6e0256,0x57ec255e586f7490,0x107c3eb17c87cfb2,0x111fef7557844019},
    {0x6befd6b30cc9eba6,0x8dfd3f56ff80223d,0x82196671314472e0,0x73232a982ff9ad2},
    {0x47f46fed983df6c8,0x450a2308a1681e90,0xf6761ce2ad1ef46d,0x2efe678292477aae},
    {0xb09c8331a00d3d44,0x54edaaa78cdb1e1c,0x847394650c096b54,0x2f8f2aa6fba53cd3},
    {0xd5bf140775c931d,0xd66a04b80da975ce,0x100676496abe2dba,0x292b12a10b792285},
    {0x3fb138831996b4b2,0xb8378782f8c9dd2d,0x1048a344d73200a5,0x17801beff6ec8614},
    {0x5bb6d08d010fefd0,0x282817df678882bd,0x299e7cee6f8aad4b,0x1d0d835e669ebb4f},
    {0x32caac99adfb500e,0x3a32c9dadf6744b8,0x6b10f67b6fdc2de9,0x1856acd0e56b899d},
    {0x27dc7a441af8076d,0x8bc308a9dd7dbc1b,0xe87b60a4b34e3f93,0x25e9f6d02ee18027},
    {0x2f8f104298a8fd4,0xab2428e9649b7118,0x2a081760f5a08950,0x1f993f4108a376ed},
    {0xa92afe68650b0e48,0x9fbd0764a446c5f5,0xe1837288e8f2c3e7,0x2aa84c46ed507d2f},
    {0x55c113dc7f8cc96b,0x97a39bc391f1b566,0x4a59b62356b475eb,0xc2d38420c2d308b},
    {0x16c54a9aed964aba,0xc43c7ee812123b87,0x30634f0ad67dec3b,0x31bf000c1c59947c},
    {0x58a67c5c252f268d,0xcc8992a6d2f2cf4a,0x921ec59f45aaf531,0x2be58c1dcd01eba7},
    {0xaae74202ede26b36,0xfb9a37c1aa5c741b,0x1a048c380b1da1b1,0x454147103dc0ff6},
    {0xb1175f64896145fb,0xce6a429a254e7315,0x6a35aeee048216c6,0x326dfea286d9878c},
    {0x51118eda1e248814,0x2ae9640fc03e6e4c,0x2aa52793cd9a32fc,0x85b4192e45eda96},
    {0x5d5ec964d57785e3,0xeebdbe71f2f03a8e,0xa85691fb3c474d5d,0x1cc6a4f18ad0c33d},
    {0x5b2a7538f4705439,0xdf81edfa85f69f98,0x53cd773ce4a5f8e5,0x205d77e496600288},
    {0x350191e20459366c,0x3a3fc71328842970,0xb5988dcb9dd2e33c,0x15dfdaf830533384},
    {0x76da9b820c9ce700,0xd95c6a258e3d0f13,0xe205735259cf1668,0x1e1333512ed2a830},
    {0x150e12da84f9abf2,0x3b85f29a4e6a129f,0xd1ead1abc2cf34ba,0x2bffdc1632213227},
    {0x3d005067bfa9cdd7,0xfbb926e74bcab59e,0x4d199fd0e92cb031,0x2caa19ee3e4ed8d2},
    {0x8478d8d977871e80,0x1ca319942c0ab175,0xfecad98c288e0305,0x2a4f8433f8d3dbc4},
    {0x5a76b0f4724f06e7,0x528e7ffb6b50389,0xd524e41275bc7197,0xbfce6758b4e3340},
    {0xa6efbff113a04f93,0x82f5ad211cb089a7,0xbf0d2e88d98539e3,0x1edcfbb30c4451bd},
    {0xb905a601756aa4ad,0x127d97ca6b25f13,0xcd1ea2840975a769,0x5e575615c8507ad},
    {0x96a4e0f03297a0bb,0x3fb962c1558c23f3,0x118f781c18d19d3e,0x15ec62fc3004f386},
    {0x1f78f7da4e13be48,0xab4af76774316aa0,0xdf322ee0d31f1941,0xc38d7811e7c810a},
    {0x927e663dc0c7849,0x5f008a2b2665c9c4,0x1c721324dd0bd662,0x1806d9f63f7d375f},
    {0x7fa5b60bfda7aaf5,0x352c91fe84a3bb4c,0x138541e7af262d3b,0xc35c74f2fb0f2db},
    {0xce08a67b7b447a8f,0x2139bbb2b75d4a11,0x32496dd087d1f4a7,0x1ba4c4869f37c7c3},
    {0x7a41452ea351aa98,0x95217901d3f5c101,0x12b14e3fb1fa45a4,0x2a71376813cde35e},
    {0xa45e16ce5be21c87,0x15b85df636b01687,0xb74466ab5e89adfd,0x1a368e60284a31fa},
    {0x60128f728f6ebb6c,0x558f3ea05a4b701a,0xee70aef681f94d1,0x2158fd9d4dcdc668},
    {0x6c84edab6d11db55,0xabd3a044ffca6515,0x98bd0790790d75a7,0x11ecd716738f2c9b},
    {0x9a99bdc18af5d7e,0xca6d8f85e2898514,0xec72e66b4a81c82,0x271666dfdae4c957},
    {0x828d20eeac9cc6d8,0xf1815bee328f75d0,0x63635917c7723f0f,0xc67595f3474460a},
    {0x3eeb2375dc22fbf1,0xe5213c2bd5281fe4,0x49fc87a9b342b72e,0x139e22f218545d2f},
    {0xcf5737846570af3b,0xf805b39e38b89a56,0xa2aae104741438,0xc219a4e642462c},
    {0x820e9c1563f4b4fa,0x7e9d170f1b7844c9,0x4bc6ec291db2987,0x2f73362f27517f5c},
    {0xf73977efc2b2bd84,0xb3f3adfe26d1a3a4,0x2dabfd8f26e64408,0x14d930f05b58868},
    {0xd19fdd89ef6f48b1,0x83ca2479a07eed6c,0x26d70c19314a2777,0x1051d2a71ccc4c68},
    {0x41c3343c46dd07b8,0x8ef1ecfcf58d64a6,0x62b2e86915eeb21d,0x232b64e41f8e2ea5},
    {0x2fd62ed84a930a1e,0x372bf100abde15b5,0xd1b80f0ff8860322,0x8e47fb8aa9c8fc1},
    {0xe410e8f9917bb9b0,0x7e42d6f6b7eccbf4,0x657920f2da11ff44,0x3610f0646837407},
    {0xcee31a776e438e6,0xda48083587004319,0xea33915f855ae16a,0x2ee4d60cc8dcebc9},
    {0xfab1a942c79de6fb,0x4795fde9a511f5f,0xc8dcc47e7017c551,0x2a980850e5b417b6},
    {0xdd25b5fd9b96cf09,0xdfbb37f4a6b17d61,0x8b636a614d11452,0x18324800d9e85007},
    {0x5ebb8479e87bd79f,0x1f0289e8bab9ce07,0x800b6bb85a4a5595,0x1c71069e6b85e434},
    {0xdeba502081aaea6b,0x1fe17af47e8cbdf,0xad4920e555166a3,0x2fd51f0d9dc4297b},
    {0x5ddfce87aa700604,0x6dfac0c04cc6a82e,0x5e1e1216c8939833,0x3034ec24546a6616},
    {0x7430f38b95b01849,0xa47c8a10798b5195,0xf8e370c21efe46e1,0x641f229d98920c4},
    {0x5d7c3bf00b8e6f2,0xe8c601a9b29dd4f0,0x29807d84d3c77c15,0x1f3a375f9da3d142},
    {0x1c7f8d1933165daa,0x1013a17c53d8616f,0xc985a9eed2c116cc,0x52edd0588c50000},
    {0xcfa46822b4e837fc,0x9811ef9a09178004,0xf554433214a877ab,0x25bd9e571edc5ecb},
    {0x8ae854241c121dff,0x8d899bb85efa2275,0xa2cb49451923fda7,0x1fc09c12ff89dc2},
    {0x7bfe2e21938c51f2,0x8d873c200f085e98,0x38ff60970c637179,0xd5168ee2282b9c6},
    {0x17c05f2ea421248b,0xaa8f7caded2b6c5a,0x68754aae4523a2c,0x32cacc24a782f9c5},
    {0x7cac9677befc92ef,0x1182e674ff64aa82,0x27614ae9f9aff650,0x315f0ffe55ea126a},
    {0x8085890ab5f71f8e,0x80b97cfa7abca121,0xa7faaff20ced382e,0x8ffa91562f94f88},
    {0x514cc1f05fc713aa,0x3aecb4d54abadb71,0x879350d828d6171e,0x31bf9cf3199ea4d0},
    {0x24c3f37f3f865889,0x6ad4d1c4b4a36fab,0xd0a7ed5186843aef,0x12d4dac0380098ab},
    {0x4477e83107d1ae76,0x4bc79a8dbc082013,0x530c7206b95f27ab,0x327f0f170b542f8b},
    {0x6e424b9d8e8ac98e,0x95ed60dbbeb9b8f1,0x939ca346d924bc89,0x2e16db3e8e537c7d},
    {0x517230a6885abd94,0x5f7353703d18e421,0x388f06e88c9b4019,0x181dfbf84cb6268b},
    {0x527f3a29034ddf19,0xea4a99803d82b2fc,0xdbaab4067c3f4fde,0x2d843c17d9b1c416},
    {0xee92debf2959169a,0xa60602abc10e0232,0xdbd59b0d4f115bc8,0xef9cb935f510c9e},
    {0x5b037beae8461d91,0x3f36633b2c52c546,0xf938fbce6b7f9696,0x241f26cced56899e},
    {0xd23c369a7303ca66,0x819e503e353a4dfc,0xca6bc7bb32f8e95e,0x23dc09c50a0291db},
    {0x2b6ab82894035422,0x75017711d0dd38d5,0x1b5f5828eacd1e65,0x166f09532f0bbb5},
    {0xad1ea09b7cb370fd,0x6495d1a06cf62de1,0x7c3713d8f6bb775,0x1b16cc319a33e7ff},
    {0xc052ca50dd38e5c0,0x7c3fd01e8f48d41c,0x4656a64bf005f7e7,0x7d2954afa282a4d},
    {0x7a96c3d347645f89,0x3275952e1152bb42,0xb7e7f29856772b16,0x2462a8ef2d0d7c2f},
    {0xf040bdcfca184539,0x6781732777e99712,0x45db74aa42931775,0x1a123f00642b18f6},
    {0x7268473f84f8488,0x3cfb26948216f478,0xfcd8e680cd34299b,0x2f529588d22cb7e9},
    {0x4d2e73f04a528473,0xa5ec078ef443dc5d,0x60bc48ccafa84a68,0x20869650b0964823},
    {0x5f8f68c640c8e477,0xcbf5844d43cfaf5b,0x1379cf3299532f37,0x12f6c09bb7847455},
    {0x9c04cf6eaf0fa435,0xf2a32618b1dfe53d,0x615afb4bdce0771c,0x29f91b7393c86bbc},
    {0x66699a9c4bba97a4,0x9d76b700ce6a4375,0xdf5ea80cbecb9334,0xc85326ad2753477},
    {0xf89c97cbe24970d4,0x29816d10d245185c,0x6fafd9e153a5c229,0xe093262152d15c0},
    {0xcb3e5f838dd23146,0x7efc885b2316f68,0xab1c4d9be64fa154,0x21126fa61a34c4ed},
    {0x6be4ef321464baec,0xf606832d397dee1a,0xacbda499de93e536,0x1ce31702a001cdb7},
    {0xfa85d4268e43e6ec,0x2d6ad19415cea651,0x69388bb48f916968,0x242ef63255fb90e},
    {0x865bd0740d552964,0xfedcb5326c5454dd,0xea6aa7f05967b66c,0xa24e7faa17eb7e9},
    {0x5402c13f9a3a73ab,0x4e72b5382e9e064d,0x2498bfce5d822339,0x23229f996b4fc806},
    {0x20d037bbb33a926b,0xffdfbef98d36e08d,0xcfb6aa61f9ae260b,0x2475ad0325cd7918},
    {0xa3c8cc1f8bbaeeae,0x47050196eefda91,0xcc2e62fb8619e722,0x206a0c2b75546f5b},
    {0x946a4216b10a687d,0x257b07831f437f91,0x31b2e9cfb0b85b60,0x623f5fc4ae95c6c},
    {0x563f0063f4af5ba0,0xf2581452ac7283f3,0xa2c325320beafded,0xbc95f07ad313bf4},
    {0x77c61b447886621b,0x9ef80d4690e31bb0,0x573eeab77dd752e5,0xd5c467cf26f4cb7},
    {0xd9385b342b1c1ac5,0x1ee6e75ba2d0d8e7,0xbdfb0e2a2f102404,0x10ce9f1c14738abc},
    {0xaa482086013366e2,0x14cafd1f55199186,0x79daf72f08302861,0x1c7ad4c44ac65fe5},
    {0x67f522aceb7850c0,0x26070d9dfc8e3874,0x3093044ddebecf78,0x1595cdf808df05c3},
    {0xccb3d6b15fee9934,0x4ca0c72c406b89f7,0x60ec29fe12c6e9c7,0x228c5dd5ab8da786},
    {0x3a25924ba5fff45,0x389feb3010073e65,0x232d27fcbfdc3e3,0x9de7442539c7eee},
    {0x177760adfa2f019,0xfebdbbe1ab32c101,0x8bb498d7e8199c6b,0xa5b4e5d6aefd07a},
    {0x1a1611fff9c2efad,0x3766cb27559ad7df,0xf62400ca26ab42b2,0x13141f5e2a1dcdf1},
    {0x5728aee501ec3ef6,0x3e7c7f11c602ccd7,0x281142551fb0d942,0x24c0ee2e3a9d124c},
    {0xd506fe40e3892a8e,0x7272ed75feeb07d7,0xbbb8130b348d1c16,0x29a0476a3511cc69},
    {0xffad1b717bf044de,0x38550cd1601df874,0xf0e42bba0f15eb79,0x8733bf9694ff9e4},
    {0x8c269ac60ebab5c5,0x443b6259da990b3c,0xa303c9cf1c8d9609,0x2ddced9c3a8ecf46},
    {0xc7aac68b09e1c3ed,0x1c7dc29d0f3815fe,0xe19dcaa931a77bf0,0x3085f312a30eef67},
    {0x5f18f65037b23688,0x2ae31b3403b17b6c,0x2db9ef0603372307,0xd37b60adb352e9},
    {0x75da24656c6af5ff,0x294647b6d8342487,0xef05cef335879a47,0xb2fef8ee9a9bbe9},
    {0x2b5226f825713c8f,0x7fe1ade6f521b0ab,0x4843024ebdc6e59c,0x1b99e98fd8f648e0},
    {0xc81d6b177487593e,0xfa33bc85f997235b,0xdbcd639b8a8b62d4,0x2d0b104d9fc69dd5},
    {0x7a9da949beaa0f63,0xcfb504221956542a,0xfe4a145911c74aac,0x4565d6431d5c6ea},
    {0x54fdc28f0b2eaab3,0xc6c54509ef941c5f,0xf843d4183e419823,0x3bea3a95c0d949f},
    {0x8b9b692fbb45b49b,0xc78624be50afc9c1,0x3305c302125415b5,0x2e1856a5376e5f0e},
    {0x41fa052ad3640ad2,0xe1f3652941a339f5,0xc4fcb82c2076d64a,0x1e2d8781ad670069},
    {0xc588f5dcdb9638da,0x496d94b078d03bfe,0x1bb02ffa796bb27a,0x3232c096c0fb0d8},
    {0xde5394be973a7db6,0x8116b3943ec8b5e4,0x1cb7087f4359895d,0x21e377ab06bb44dd},
    {0x7813e3bc98c2eb5f,0xd222a0cd5e5654b8,0xe586dcf12bb76206,0x11b4c7f5ad98e219},
    {0x1a6b5f8942eb62d5,0x13e93729f2a79b6e,0x4f217e4ae26ec853,0x13c44c1db9d08ea6},
    {0xf332b20a6cf53e95,0xa662ed671198e1ab,0x612e12562ed0c2b4,0x1a883894fb7d88b7},
    {0x4f3239ef683a3eb9,0xa4bcd7fa1eb94547,0x1d2b56347cf77fb2,0x12c1b74d505f50db},
    {0xb77b501fe5a0b2ee,0x3334451beaf46cf7,0x3f28acf9e8d3c615,0x1997f8ef617d7b6b},
    {0x4f450423788e3e68,0x5fed42e182060da8,0x3718523a957c34b7,0x1c8ef8ae8c1e1ea0},
    {0xbce336e354e0892,0x5ad3204c7b9db3bd,0xe58607145172d55e,0x237083dca712898e},
    {0x78236d6e9fccd306,0x4e8ae8d315dd7b22,0xed9f107751d98001,0x1ce5940e8fd238b0},
    {0x3518ebcc65641e28,0x6349b123b32e02ed,0x22755329a737633c,0x85ae1add202c2f0},
    {0x5c2a72704232bca5,0x54c7be15fdfda5df,0x555f6536787c8159,0x156fcfa718e949be},
    {0xf3578b8dd1f49f03,0x967b2dfe783fcc6c,0xf86c9f2a07adcbbb,0x229fbcd5cca97727},
    {0x25ab8666c05ef331,0x993ce653bc8181a7,0x1c6629a3635fb515,0x34d4b87bf557bbe4},
    {0x6dfb6c37c9fecd67,0x724a38fa53b12148,0xbf327f7266d8eef0,0x213e838ff0a981ce},
    {0x95a102e3ef41da2a,0x28deacec87e43ff7,0x268b030dbbc66da7,0x1a8a765ab4250249},
    {0x6b7247a26d24905,0xb8a4d73a77bda368,0xe17a71c72cb94390,0x10a0c0652ed3f804},
    {0x21ea7643b3cda58d,0xdcce50c1c4fa0f73,0x1e7904fa80bb47fe,0x2906cf6519249bc5},
    {0x35ae69bcd391a2a7,0xbc6df4c35a201a91,0xa22ab6cf965c5d96,0x23a97c5b9dd5e1a4},
    {0x585142a272c1cc41,0x2e26c0543a691f22,0x29d6defdbed614c9,0x1013a46e36c08000},
    {0x909c3a57df5dc8da,0x65019145a38fe556,0x49d269373ea831f6,0x32e71a0e26f747e9},
    {0x2049507cdd36e312,0xcab56de4b7bc4f6,0xe4f6da16b04d379c,0x32f43cc7092aedea},
    {0x649c6ae9d2e4fe16,0xcd53068dd05be37d,0x8e2a4da904197e82,0x1354ad4363b9eded},
    {0x16d8cb49278dc440,0x609bb85da4fb2be3,0xbe4ffec9410b0802,0x1059dc4535148ea},
    {0xcfc89c019850a6cc,0x72fa65f731f44e2f,0x8c30f538a8a1f210,0x2d4bf75c88350d42},
    {0xf21864df9317d739,0x23ee4f862857d6f9,0xe386545919a72b74,0x32420f683edaead4},
    {0x98d6988bf6b2cb26,0x92168e64a7d24131,0x1dd268ac8c373aa1,0x3bfdbe88fbc12b6},
    {0x2fc34b72aaae2bbf,0x35043fddc3832320,0x43f193f608634c44,0x12ab3f4bf040ab7a},
    {0xb53e5d937f565801,0x9ca75f5fc55c473e,0x8c43cda630b6d490,0x31cefd2328a87ce},
    {0xf605c162a1727841,0xf8ff3e85f6cfcdc,0xa60b89eaef0b191f,0x648732bb694cd93},
    {0x4632aa3bd7dfe1bc,0xcdb448e8066dbe3c,0x786a7d57ff30135b,0x22fb30ac6478019d},
    {0xd1228c5bbd37ac5,0x1db0d172bcdd57f7,0x634962fe7fb81b5e,0x1c96eb0ea054c976},
    {0x671b8dc0144f14a,0xd117743e6e503174,0x15bfe3b985e33587,0x104fb7626a5a8610},
    {0xcbb7aa9b6329b9dd,0x365e01c98e1c56c,0xf119a4e4a2af2127,0x20669e586d4797c1},
    {0x7bd819af33644fd,0xffad0942a4559c82,0xa803e372d7324f7f,0x2e9c6ba47ab4b44b},
    {0x83d387daf8f63f41,0xebbe6908395f199a,0xc4f27f1a89a2d2d6,0x2f3d0259ab12ea67},
    {0x6edaba281c3c185c,0xff936563eccc9c72,0xcee69f683018825c,0x2e86056086d5c977},
    {0xe91df9bb3e28f64e,0xa5c051bd67613be0,0x5e6e3d867b8e4f6a,0x5709615aaa759f5},
    {0x377009626522d26d,0x2dc6bffa07bf4cae,0xe7705d4d5b4d2d76,0x78bcb24242ae698},
    {0x57247852642df3f4,0x2c26613c15673922,0x7cd7a0fdbaae7e8f,0x3100fc2e79e57209},
    {0xbab7116a142dd2e3,0x6d6847f6c8212039,0xa4e0a00523ec370,0x254a4fd187e85dd6},
    {0x536a346862845d9a,0x29a8248d5c4e718e,0xd324c8c3f2225347,0x31ec6965407deabe},
    {0xb31d9dfe33f2a6ca,0xd5c4b061323c64f7,0x941659086a6e0bb6,0x267e211278b193c9},
    {0x21eabdc7710bb52d,0x92a4e325f4a48987,0xeaf49bac904f0464,0x155e3777317be5},
    {0xc97b81ddf308827d,0xbd57985a9f2df34d,0xaa41dd03cc8f3cb6,0x261130851c3bf746},
    {0xb60ef17e2be0d462,0xdadb1386967be952,0xc2ab4cb911eca13a,0x2ba18f7399a2a6a9},
    {0xdd8df15fd720e97b,0xdac750f206d16f3a,0x33eed7041a059e7f,0xe5f33f26295b4d0},
    {0xc533086a18a3c925,0x5f0a3aa2911aed75,0xad6688d5b44a4994,0x2753b8e09cb344f4},
    {0x1f50235d31573312,0x36d72b22f47d5078,0xea237772da79e23a,0x2a98e37bcf2cb2a2},
    {0x87416bbecd4b00f6,0x5e871157b37333ce,0x8ad235ceaea55471,0x1f0b653f8cf75a10},
    {0x2c8aee0c9481806a,0xdd0aeb9e4a87a4f6,0x69f72b450ab14a4,0x170e9070dd0cbe08},
    {0xcbac69c93195022,0x98a739ab7680f0f4,0xd27b6e97d90fe2e9,0x1d67fe36f9436daa},
    {0xd3265d4ebe2a63df,0xf264532e622c37ba,0xc4cec1eb1805e1b8,0x21f3d1b4e14643b6},
    {0xc9dabe48ac741f55,0xa1553e7e05c5ef30,0x9a09d5b25ab08a2,0xb633ec35eb28ea1},
    {0xb40309759239645c,0xf2274d18991edb7f,0x821480ededc3f317,0x287e0ab1bcbb3521},
    {0x67f41fb3ecfa635b,0x786288b136a2d4af,0xf23c3c4045825c6c,0x56b01fb5c8c77d8},
    {0x25e458b4a732e2a,0xf544594c1a2ce35d,0xe6287122b952fd90,0x1af80bdbe47e4da2},
    {0x4645f2f560878a66,0x36f3de47dbb09a,0xccc443db303c7749,0x137dcaf4d7e97ab2},
    {0x3b1fdcf7fedc7813,0xf699dbba8a2cb37e,0xb422d18422a998a6,0x20666153ae8885ad},
    {0xf3c662ea68e41a27,0x6a8fc4bfc65ab7b5,0x36a5bc276cceca47,0x143559d400bb16a5},
    {0x827ffd5b069ad045,0x494ca903c06ffec0,0xd84312c5c95db93,0x2e5ea31e484451bd},
    {0xabbfa61c639057ab,0xcd94637623c9a865,0xa31dcc7009f4d3a0,0x157da83c79cb8bf},
    {0x9dc5e38dc2a054e3,0xd89e37bb6f9834db,0x5f73912686188cb5,0xb66d688ae599ddb},
    {0x59d2d59d848b279a,0xd88257a74e1448a5,0x2dc45dea46899204,0x127ee8b4b703e781},
    {0xa76fb7703b574990,0x51c9700d7590ce40,0x45ba8e44719f88cb,0x15f9ca973b040542},
    {0xf548859d7b1a2cde,0x3e41cccea8e62f4c,0xdf11525d4ed35ce5,0x9a4661e1051ac13},
    {0x6417df63f70ea49d,0xbf14d2fd22860a42,0x76d6e499ca0ba4e0,0x18fccacf504d6ea3},
    {0x330ea7bad9561896,0xda60c0c5e7a7b379,0xd101f376dd6b8d61,0x21e4dd9392d25d61},
    {0x959be740148d2904,0x98a22ea755391c92,0x8dce659da9484b02,0x2107a3325b3a4f1},
    {0x6b0177fa83cda241,0x7f8de10a917b7590,0x660869179feb7f2e,0x11e30e63595920d9},
    {0x94bd4f8b69795767,0x5fa652b0c049824c,0xd148ec835fdbd3e2,0x252858e9b1ae150c},
    {0xa54ed3e4affbd77,0x3851b5c7f58db04d,0xc32890b3478c126b,0x456c0442d116a7a},
    {0xf9b8cfc64915b6be,0x69c2c9f93373195f,0x51006b12544b9eee,0x1de1dfa195a6777f},
    {0x82d8ecc317699b4a,0x949ac56216fd23b6,0x5d1e4b9f904f53f1,0xe172ab0bbafd694},
    {0x3682011883e613e9,0x4427a3175a5f6786,0x7f2487f95e75d96f,0x2e16952347e79aba},
    {0xb6d34d0d9048b4b9,0x293cd16e7552146d,0x9a3c4900eb827211,0x20a32ed7d3f1c880},
    {0x626de9c866c3b738,0xc565d06e3bbdfc2e,0x62803dcd2869e71e,0xabd0d0fb9157b09},
    {0x41ff10ecdd832dcb,0xdf5acb5d5b551530,0xa6850cc478bde71a,0x1afad6c15dc58ea6},
    {0xb8313b29d2947e64,0xf129dc39038d902b,0x2453fc3c67f135a4,0x88b77023c28ae77},
    {0x45cebfe8af78156d,0xe62235a503d24bd0,0xe05af3b4ae6cfea1,0x1985984fb25bc94c},
    {0x75f0730133653099,0x8f9ddea5bbf8f785,0x22b9c90f086fddfa,0xfbe38d254098966},
    {0x76ac1e669ce103f5,0xe081890e5d05b2aa,0x154ecefa3287db31,0x182f8122c8919fd1},
    {0xcc4046645af81c0b,0xeb0776e0a48fe16d,0x96f164a837307075,0x2bf4903c67fc2150},
    {0xd63e1f91451c7d69,0xcef0650823c02e35,0x7c1ef34b6841e93c,0x2b76a7eebcdfa057},
    {0x3a699388e9f54405,0xbef8696b56c4d9b3,0xd954e01af17db0e2,0x42abfdd0b82983e},
    {0x6731fdb01a973dc4,0x1cfae895c83c9486,0x1772b8bb88ca0061,0x33848ecbed58c002},
    {0x3778471a7547b1e1,0x7b61eb8b61712798,0x2b87ddbfe1d1204f,0x27ced8a2835701b8},
    {0xd5b79e98a4761d9f,0x8852aa0b0720cdae,0xafb678fc442729f5,0x136c1a580a0a0a1a},
    {0xf9527c574277301c,0x351857ed7a4d425d,0x6bec6f265b096321,0x1f112a7d382cb4be},
    {0x545090fb5e40090b,0xffc39745980fa813,0x1cb2360a20d6b681,0x6dd32289c575563},
    {0xfe776faa06f7f1bb,0xde4664450a2bd75d,0xcd8457c9b9349bf2,0x8e3cd1addffdb7},
    {0x4ca246d006499538,0xfe3631737dbfc12d,0x822972e2df0a284,0x1d2f76be43fb101f},
    {0xaab397483e55fd2a,0x294577d9127e031f,0x70ab0e0100f294b4,0xa3a7838cd74d695},
    {0x5fc4e829fd87bca,0xfdaac025160280d3,0xac8aa7d980a54048,0x25930288becd0a98},
    {0xf14140b6139b0386,0xba9ca129733ba11a,0x1db85005b797c7bc,0x2ebd0c70be64e57e},
    {0xe56e008a5c96a142,0x4a8fc551c4dadeb5,0x53fff4d1611cfc1,0x2743a501ab267250},
    {0xa4d6630105959e5f,0x4dd63d2b06e288f9,0xfa6214f4498d54bc,0x3404b79ca5372e32},
    {0xe27b4042bafe1488,0xed1cdf798e129795,0xcef4bfe51da83112,0x258e1f7b9978ffba},
    {0xdd1cee4a6de5ac15,0xf141b28a6def6fb8,0xb97e3de226ba603b,0x300a500b0dc30ea9},
    {0x7e0b48fc3e8c0a49,0xc348ff7ba811d226,0xb0f96b3e4073d69a,0x117107639b692d35},
    {0x30df654d9632015f,0xf705f7d762310ea1,0xd80e1e9936bb72ad,0x14be046dab6c36f5},
    {0x2d71f6f9cb3783dd,0x136a87a29c7ce709,0x867e48315cf09ab8,0x22814dc0cd07c0e1},
    {0x46d75ea9a43ce001,0xa7969243fef81258,0xd135356ad114fbcb,0xe038db277a59ab1},
    {0xd9bf8bd1660c650,0x5b9832c4b9b12095,0x592f5b1c5f735d15,0x17f34dc36cf78592},
    {0x9cdcbde6163d857b,0x6e014f44057e0110,0x365223d7d30be945,0x203bcba1f3ba627a},
    {0xaae56fd9d036ee37,0x91b00296913e0c2d,0x3b7d258d7fa1f933,0x2dfc36d59094f650},
    {0x15e14bd70aaff5d9,0xf36907c450cab31,0x45c2db81bd5bdd23,0x26df7eb8ee45e826},
    {0xe7220562a56e547b,0xad2a44a942e5090c,0x47e176176641bacb,0x2aab70c3643ab258},
    {0xd859df9b1922f3ab,0x11dad7cdd1fee986,0x953962e94aec49c9,0xe234b341a521f0e},
    {0xa129f6cefdcda8ef,0xf0a688c3dc30a0e4,0x4b676408cffa2c6f,0x13ef0af0846b92b8},
    {0x5a8ef03d0219a09a,0xb40cd16dab94b3d2,0xb37d753a341fcfd6,0x2b36314f08f007d8},
    {0x71e80c88d6a73d88,0x4b7168f8fa75d277,0xc0f049c89ba2010f,0x9f853889a1b1c86},
    {0x74292c08cac21a38,0x3424cba8cef8b311,0x987f547113fdcdbf,0x28a54e27a5dd48dd},
    {0xd37cce93b04027da,0x4616f376605acff4,0x686170e96aaa64bd,0x3479215b2c660dff},
    {0x42a2c3167cc2b915,0xb99099356a23a82d,0xa463dac573e0e5ca,0x11802a6ac2c7a4d1},
    {0xee797ee6406916a2,0x206cbc02d5f151a4,0x3a8a8fe665e5c24,0x119195b1f9828956},
    {0x1b6c7c250c89b830,0x86eadb90d3e2266b,0x22413f48b17485cb,0x280ad8627ca12413},
    {0x5d7cdd311f6cf8c7,0xb6fffad311347eae,0xfd4c07d0190ca1cb,0x28928930c9757b8c},
    {0x3bf21935721f8f95,0x7071fcff4ca67184,0x414c2761b076e065,0x158abfe2412cf855},
    {0x880b6e6fcab22201,0xcbde277e08f18310,0x508897dd84853e3e,0x5f2021cb00306a2},
    {0xa634be3062073e8b,0xce43fd9cac52c457,0xb2347a87227e9b70,0x306616cdbd8defef},
    {0x5d3c9bbd810fd12b,0x5512ca6c65b76bf6,0x877e305118f7be44,0x2982748ba47f7d00},
    {0x1fd6c343afb341dd,0xeb6497972a3d819,0x1bf9c8aebb152953,0x2fc494a027236922},
    {0x2fad6e48a7f21cd5,0x51dfedd38d11751c,0x9c77fbc6ef45dc43,0xcb0b452670f485a},
    {0x63a44e3eedc876cb,0xd2efbafbb7fab098,0xf54b7bbb75710d0a,0x23bbc6122eb35924},
    {0x4d477f1211e181f8,0x155611883a6923a3,0x79b76dca48e1990a,0xc8c412341eace0f},
    {0x358e8960c18e0beb,0xce432cfbeb0f1d67,0xa53f3c78469df4a2,0x21146b348f8f92fd},
    {0x5b61483162145c1d,0xe392926bce0115ee,0x9ba0bd4a7b7fbaa6,0xe0d5ca192de3194},
    {0x708c01e43dd2c89b,0xe56490d02b3fabc4,0x9be3fcaad43434d9,0x9357bebdfda340e},
    {0xe2b2e5f4ddc19256,0x42d7b7bc0351c3e0,0xe0d0daf984bb4c9,0x2daf3189a5e421b4},
    {0xf4002a571108b3b0,0xc3b57ca09a46fcd3,0xd567c556d00a7a25,0x1617adebda22cc85},
    {0xd9b6321ade0353c5,0x95ab1a23ec5155ab,0xdf79240a5cdbc45c,0x1f9e28277b07b7a0},
    {0x5e57195367dc968b,0xe4a9fa484787ec9e,0x773334fe086522b3,0x1bd175ca0aaac90a},
    {0x9e97beef95a0ce,0xfecfdc68534a48ef,0x655279660e7a2de5,0x1662d2f628102d47},
    {0xcc2fb024232b84c9,0xeb8083298aa264e6,0xcfc71ce40dea6ceb,0x9472ffebeba5560},
    {0xc903bacbd34a1563,0x20137248f9d5c295,0x407e48f1d1580623,0x47f1d934aefa5e4},
    {0xbc8e599eb18d02ba,0xc4119fe6040f02fd,0x555610fbe13e1889,0x27540aa2451045f6},
    {0x6bb8aa4c032a595b,0xfd2a154079161bbe,0xc39f5ad069e36f09,0x229b2352ce88edd7},
    {0x362f8d181f472b68,0xe162a03b6ff15f2b,0x5a5de5169e17ea8,0x1bd4522ca59a6a},
    {0xd42883acaa60ada7,0x4dad147d9792d941,0xce40f6195750c37c,0x1b890eb4af213058},
    {0xd3952af16d3515a0,0xa3312e27288ed85b,0xaa60984e28ece805,0x2299ca85f93f14e3},
    {0x47538452a0185aa1,0x75c6480dd91f8a21,0x8f8b80d46f89bd15,0x641bf678bba93fe},
    {0x74a228efd23b2564,0x21ae1dcd719a3835,0x70c4f64f07f63873,0x176363b1f08f502e},
    {0x39f2e353f7aee4fa,0xb170b87b94f220b5,0xa0293822959b07f3,0x2a164e110eb74de1},
    {0x14caf273a08352a5,0xc5bf1601300e7657,0x2c311e4c23d2d05a,0x290730594707a84d},
    {0x2b862049d9aded4f,0xd6502b8b9f703530,0x8869cdbd7f25dcd3,0x1dee7719a9b9ee96},
    {0x2fecf745903c078e,0x68ab8b255c8a7c2e,0x17f2fe5280b55966,0xa3ed9654e923415},
    {0x479bbb7fe912b113,0x3edbc821f258a12d,0x717410cd957d8b56,0x2b559a5621794ab0},
    {0x31b82c21e3691d54,0x8213f6b31fa08fa2,0x67a829b0444819a4,0x2e2e8da81ed947b7},
    {0xb5a8ceec4a5d86c6,0x23efef5118a2681,0xfac8b9e374f08a65,0x2b1bc3694f5455e2},
    {0x43babfdca5548130,0x895e923ae1ff9e75,0xbbd41cf973f18b6,0x2095d9516aec61af},
    {0x57714c299d7842b4,0x638fcaf77ef772ea,0x6571708782847497,0x1cadd433e39381b8},
    {0xceae55dead700149,0x5153b19372cbabeb,0x331ddbd0102b5d63,0xb9f8030ecc93f8e},
    {0xc8d8ea592379278f,0xb950e7080669c946,0x5cb509d03d66e757,0xcf54d2d827cad23},
    {0xd6d0ebeb6fcdf749,0x851595e89b0cdd8e,0x2fe49160440a56a8,0x1a13ebce99a1ed62},
    {0xc09fa1596be98703,0xad370f870e6e1656,0xac4e4e8c34e91f5d,0x2afa3eda48df27a7},
    {0xcd35e5aad868ccb7,0x2d1c6627bd0f8cc4,0xae6c77bba83ac7c6,0x18b059fe8b4323fb},
    {0x5ee7f38f302bf7d2,0x925a5e30668d3ac3,0x976d20fbed987989,0x15741863fe3b9147},
    {0xbd6874f2dc338aee,0xf1ebf06c01d9279a,0x63846aa208e6fdac,0x13622f8079508b90},
    {0xe846382e3b923025,0x9b5d6192d4609940,0x79ea5dafab094b1b,0x1995795939a95690},
    {0x541f7cf3c0f28f0b,0x6fca39747fab1957,0x1c90efc83a46d6c1,0x60febc6471ea686},
    {0xb08423880b1b7a34,0x99c5ce7e0c2fe0cd,0x7c3fe06f612d5125,0x1ab914b6d5f0e62},
    {0x9903c63521b47aef,0x5a46e3b5e73e5640,0x7fb81ca93c66647,0x18c246355f89e31c},
    {0xe91ce66a303418d,0x638c52e00cbfbc86,0xff95e52a92a96009,0xdef2a6fe8a3ad0c},
    {0xfb51352fff9f0fb,0x6db33c912b404184,0x554a296642c9d772,0x25b5a3de7a9c51aa},
    {0x45c050529ce8a083,0xf7c226d14d10145f,0x90ff3f8297254ee9,0x1e08e91766d2af8f},
    {0x2cc0b1b43fa50881,0xfcffcb793ef7e94c,0x379e206d3ac497f4,0xa72cdb28cb94ef4},
    {0xbe22ad9208a8efb7,0x3642962a99b46a40,0x32f1a25c1ddb1515,0x2afe08bea382e708},
    {0x1ef72492a68c9d39,0xf1c8220f0662b776,0xdb2bae1abe016348,0x1bf7afe05021a363},
    {0x1ef5e60ed2684a7f,0x5448882ba4207172,0xf557bced3b10543c,0x1f77ba267c1455ce},
    {0x3c9d073826aaf842,0xc34967a18dbc88d9,0x26d0fa375ccad99a,0x2e10baf13cf8d3f2},
    {0xdd5605cf189192f4,0x4de2bdd9d9e60b4c,0x35092f78cb95aea8,0x2e01c7f40bcd76ed},
    {0x7448d8eb28f8bab9,0xe92a3beb96571f6f,0xbfe8a0af102b665,0x280bea432501a23d},
    {0x60b0d2d4fa0f8678,0xec188c07c058e8e,0x7c1cfcee78ef9b9e,0x2153d785a14634e7},
    {0x3b21d2696f4d1011,0xb40efb1d0da32af,0xb2dfaabc31ccf5e1,0x112a0a95ddfa2856},
    {0x8fc33ee0e84b2e92,0x9d809b4f3c49ade1,0x69085d1267418e1d,0x9ab428834bad862},
    {0xfceafb04510c9ace,0xa4975a12164fe2e8,0xac6e94f9289ef2bc,0x247d5b48a02a8820},
    {0x40790555e5070ebd,0xcf27f3702b7c20f6,0xdedb6660c7fa4f2f,0x303a5ebe971d7fe1},
    {0x1391d4832799060f,0x4b79be67e8453d35,0x935ec27f9e881945,0x2e9673713fec1704},
    {0x95c324a9d50f5dd8,0x86a33ac265d96fb7,0x6764a9c1baedf46e,0x1b6d2bd6dd658168},
    {0xb60aab5f92a4e201,0x77b21233cdec309d,0xbe65ab0a1476f0a8,0x2f0dd8986e0dd10b},
    {0x8d1d8d5c9ce69ae2,0xaa87b76aa3a10827,0x539a06ef3da1234e,0x1036aea0b22398b6},
    {0x38866f7449dff8db,0x96dedb6d237864cc,0xca67a311ae3bd45e,0xf0548215981f0d8},
    {0xc57056ca4fa620aa,0x8047e051c5168353,0xe0d35fe4b91ed7ec,0x1248dd52545af37a},
    {0x435c9b0bc992fb0e,0x59f4c731d3634958,0xddacb2db75657887,0x7c504d373cf09e8},
    {0x51e05f4d788fdd46,0x2c5851fffdd34e8,0x117a3df980f328c4,0xd2ffd1c83b81922},
    {0xe598b26896545471,0xc612daa47420f9d1,0x14e0984fb021bcdf,0x497ce310e4a24a8}
};
const fp_t LookuptableLR[32] =  {
    {0x90e292e17fbe4107,0xb776b87117ea4a3a,0x29fcba3b471f1dbf,0x4e1f858cf37d16},
    {0x159ada1e9c263d8a,0xb47f94bda2b0cbff,0x38b5164bc8864a26,0x2ac98b9548af6a3f},
    {0x86ba4c2edecece25,0x39a28abece33c462,0x32d57566805513ce,0x14a0879d422e4673},
    {0x1ee1db5e232f6d9a,0xca5c22e7f907da34,0xf492ed7be6bb8e46,0x211289d092315977},
    {0xc593add0e3a3323,0x83f18909c01a3637,0x5f0f596126502f2c,0x3043aae1d4c4dd3f},
    {0xd7376b0d03f084b7,0x93b117bb09cc27cb,0x65d45a58eb887bb1,0xd528d07760a63f1},
    {0x8e5eff4ad48a819d,0x65c6029504c2b018,0xdc7491a4eb01dc41,0x1c2a2f50d57752d6},
    {0x71a100b52b757e62,0xbf669bb4308e97e7,0x573216c09c3e97f5,0x18b86ed7961e86b5},
    {0x28c894f2fc0f7b48,0x917b868e2b852034,0xcdd24e0c9bb7f885,0x27901120f58b759a},
    {0xf3a6c522f1c5ccdc,0xa13b153f753711c8,0xd4974f0460f0450a,0x49ef34696d0fc4c},
    {0xe11e24a1dcd09265,0x5ad07b613c496dcb,0x3f13bae9a084e5f0,0x13d01457d9648014},
    {0x7945b3d1213131da,0xeb8a138a671d839d,0xd132ff06eb6068,0x2042168b29679319},
    {0xea6525e163d9c275,0x70ad098b92a07c00,0xfaf19219beba2a10,0xa19129322e66f4c},
    {0x6f1d6d1e8041bef8,0x6db5e5d81d66fdc5,0x9a9ee2a40215677,0x34947ea2dea25c76},
    {0x0,0x0,0x0,0x0},
    {0xfffffffffffffffb,0xb9df176e0a9667ff,0x24149fba4424513,0x86d16ca19ed3fbd},
    {0x159ada1e9c263d8a,0xb47f94bda2b0cbff,0x38b5164bc8864a26,0x2ac98b9548af6a3f},
    {0x6f1d6d1e8041bef8,0x6db5e5d81d66fdc5,0x9a9ee2a40215677,0x34947ea2dea25c76},
    {0x1ee1db5e232f6d9a,0xca5c22e7f907da34,0xf492ed7be6bb8e46,0x211289d092315977},
    {0x7945b3d1213131da,0xeb8a138a671d839d,0xd132ff06eb6068,0x2042168b29679319},
    {0xd7376b0d03f084b7,0x93b117bb09cc27cb,0x65d45a58eb887bb1,0xd528d07760a63f1},
    {0xf3a6c522f1c5ccdc,0xa13b153f753711c8,0xd4974f0460f0450a,0x49ef34696d0fc4c},
    {0x71a100b52b757e62,0xbf669bb4308e97e7,0x573216c09c3e97f5,0x18b86ed7961e86b5},
    {0x71a100b52b757e62,0xbf669bb4308e97e7,0x573216c09c3e97f5,0x18b86ed7961e86b5},
    {0xf3a6c522f1c5ccdc,0xa13b153f753711c8,0xd4974f0460f0450a,0x49ef34696d0fc4c},
    {0xd7376b0d03f084b7,0x93b117bb09cc27cb,0x65d45a58eb887bb1,0xd528d07760a63f1},
    {0x7945b3d1213131da,0xeb8a138a671d839d,0xd132ff06eb6068,0x2042168b29679319},
    {0x1ee1db5e232f6d9a,0xca5c22e7f907da34,0xf492ed7be6bb8e46,0x211289d092315977},
    {0x6f1d6d1e8041bef8,0x6db5e5d81d66fdc5,0x9a9ee2a40215677,0x34947ea2dea25c76},
    {0x159ada1e9c263d8a,0xb47f94bda2b0cbff,0x38b5164bc8864a26,0x2ac98b9548af6a3f},
    {0xfffffffffffffffb,0xb9df176e0a9667ff,0x24149fba4424513,0x86d16ca19ed3fbd},
    {0x0,0x0,0x0,0x0}
};


const __uint128_t mask = ((__uint128_t)0x7FF<<64)+(__uint128_t)0xFFFFFFFFFFFFFFFF;

void int2t_add(int_two_torsion* out, const int_two_torsion a, const int_two_torsion b)
{
    *out = a + b;
    *out &= mask;
}

void int2t_sub(int_two_torsion* out, const int_two_torsion a, const int_two_torsion b)
{
    *out = a - b;
    *out &= mask;
}

void int2t_neg(int_two_torsion* out, const int_two_torsion a)
{
    __uint128_t zero = 0;
    *out = zero - a;
    *out &= mask;
}

void int2t_mul(int_two_torsion* out, const int_two_torsion a, const int_two_torsion b)
{
    *out = a * b;
    *out &= mask;
}

void int2t_inv(int_two_torsion* out, const int_two_torsion a)
{
    *out = a;
    *out += ((a + 2) & 4) << 1;
    for (int i = 0; i < 5; i++)
    {
        *out *= (2 - (a * *out));
    }
    *out &= mask;
}

void int2t_toarray(digit_t* out, const int_two_torsion a)
{
    out[0] = (digit_t)a;
    out[1] = (digit_t)(a >> 64);
}


void fp_set(digit_t* x, const digit_t val)
{ // Set field element x = val, where val has wordsize

    x[0] = val;
    for (unsigned int i = 1; i < NWORDS_FIELD; i++) {
        x[i] = 0;
    }
}

void fp_mont_setone(digit_t* out1) {
    out1[0] = 0x4;
    out1[1] = UINT64_C(0x6b4d86db2abae000);
    out1[2] = UINT64_C(0x31655e69e2fe2f23);
    out1[3] = UINT64_C(0x2c75875e51a899cf);
}

bool fp_is_equal(const digit_t* a, const digit_t* b)
{ // Compare two field elements in constant time
  // Returns 1 (true) if a=b, 0 (false) otherwise
    digit_t r = 0;

    for (unsigned int i = 0; i < NWORDS_FIELD; i++)
        r |= a[i] ^ b[i];

    return (bool)is_digit_zero_ct(r);
}

bool fp_is_zero(const digit_t* a)
{ // Is a field element zero?
  // Returns 1 (true) if a=0, 0 (false) otherwise
    digit_t r = 0;

    for (unsigned int i = 0; i < NWORDS_FIELD; i++)
        r |= a[i] ^ 0;

    return (bool)is_digit_zero_ct(r);
}

void fp_copy(digit_t* out, const digit_t* a)
{
    memcpy(out, a, NWORDS_FIELD*RADIX/8);
}

void fp_neg(digit_t* out, const digit_t* a)
{ // Modular negation, out = -a mod p
  // Input: a in [0, p-1] 
  // Output: out in [0, p-1] 
    unsigned int i, borrow = 0;

    for (i = 0; i < NWORDS_FIELD; i++) {
        SUBC(out[i], borrow, ((digit_t*)p)[i], a[i], borrow);
    }
    fp_sub(out, out, (digit_t*)p);
}

void fp_tomont(digit_t* out, const digit_t* a)
{ // Conversion to Montgomery representation
  // out = a*R^2*R^(-1) mod p = a*R mod p, where a in [0, p-1].

    fp_mul(out, a, (digit_t*)&R2);
}

void fp_frommont(digit_t* out, const digit_t* a)
{ // Conversion from Montgomery representation to standard representation
  // out = a*R^(-1) mod p, where a in [0, p-1].
    digit_t one[NWORDS_FIELD] = {0};

    one[0] = 1;
    fp_mul(out, a, one);
}

void MUL(digit_t* out, const digit_t a, const digit_t b)
{ // Digit multiplication, digit*digit -> 2-digit result 
  // Inputs: a, b in [0, 2^w-1], where w is the computer wordsize 
  // Output: 0 < out < 2^(2w)-1    
    register digit_t al, ah, bl, bh, temp;
    digit_t albl, albh, ahbl, ahbh, res1, res2, res3, carry;
    digit_t mask_low = (digit_t)(-1) >> (sizeof(digit_t)*4), mask_high = (digit_t)(-1) << (sizeof(digit_t)*4);

    al = a & mask_low;                        // Low part
    ah = a >> (sizeof(digit_t)*4);            // High part
    bl = b & mask_low;
    bh = b >> (sizeof(digit_t)*4);

    albl = al * bl;
    albh = al * bh;
    ahbl = ah * bl;
    ahbh = ah * bh;
    out[0] = albl & mask_low;                 // out00

    res1 = albl >> (sizeof(digit_t)*4);
    res2 = ahbl & mask_low;
    res3 = albh & mask_low;
    temp = res1 + res2 + res3;
    carry = temp >> (sizeof(digit_t)*4);
    out[0] ^= temp << (sizeof(digit_t)*4);    // out01   

    res1 = ahbl >> (sizeof(digit_t)*4);
    res2 = albh >> (sizeof(digit_t)*4);
    res3 = ahbh & mask_low;
    temp = res1 + res2 + res3 + carry;
    out[1] = temp & mask_low;                 // out10 
    carry = temp & mask_high;
    out[1] ^= (ahbh & mask_high) + carry;     // out11
}

digit_t mp_shiftr(digit_t* x, const unsigned int shift, const unsigned int nwords)
{ // Multiprecision right shift
    digit_t bit_out = x[0] & 1;

    for (unsigned int i = 0; i < nwords-1; i++) {
        SHIFTR(x[i+1], x[i], shift, x[i], RADIX);
    }
    x[nwords-1] >>= shift;
    return bit_out;
}

void mp_shiftl(digit_t* x, const unsigned int shift, const unsigned int nwords)
{ // Multiprecision left shift

    for (int i = nwords-1; i > 0; i--) {
        SHIFTL(x[i], x[i-1], shift, x[i], RADIX);
    }
    x[0] <<= shift;
}

static void fp_exp3div4(digit_t* out, const digit_t* a)
{ // Fixed exponentiation out = a^((p-3)/4) mod p
  // Input: a in [0, p-1] 
  // Output: out in [0, p-1] 
  // Requirement: p = 3(mod 4)
    fp_t p_t, acc;
    digit_t bit;

    memcpy((digit_t*)p_t, (digit_t*)p, NWORDS_FIELD*RADIX/8);
    memcpy((digit_t*)acc, (digit_t*)a, NWORDS_FIELD*RADIX/8);
    mp_shiftr(p_t, 1, NWORDS_FIELD);
    mp_shiftr(p_t, 1, NWORDS_FIELD);
    fp_set(out, 1);
    fp_tomont(out, out);

    for (int i = 0; i < NWORDS_FIELD*RADIX-2; i++) {
        bit = p_t[0] & 1;
        mp_shiftr(p_t, 1, NWORDS_FIELD);
        if (bit == 1) {
            fp_mul(out, out, acc);
        }
        fp_sqr(acc, acc);
    }
}

void fp_inv(digit_t* a)
{ // Modular inversion, out = x^-1*R mod p, where R = 2^(w*nwords), w is the computer wordsize and nwords is the number of words to represent p
  // Input: a=xR in [0, p-1] 
  // Output: out in [0, p-1]. It outputs 0 if the input does not have an inverse  
  // Requirement: Ceiling(Log(p)) < w*nwords
    fp_t t;

    fp_exp3div4(t, a);
    fp_sqr(t, t);
    fp_sqr(t, t);
    fp_mul(a, t, a);    // a^(p-2)
}

bool fp_is_square(const digit_t* a)
{ // Is field element a square?
  // Output: out = 0 (false), 1 (true)
    fp_t t, one;

    fp_exp3div4(t, a);
    fp_sqr(t, t);
    fp_mul(t, t, a);    // a^((p-1)/2)
    fp_frommont(t, t);
    fp_set(one, 1);

    return fp_is_equal(t, one);
}

void fp_sqrt(digit_t* a)
{ // Square root computation, out = a^((p+1)/4) mod p
    fp_t t;

    fp_exp3div4(t, a);
    fp_mul(a, t, a);    // a^((p+1)/4)
}